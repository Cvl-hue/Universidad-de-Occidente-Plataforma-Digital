<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Plataforma Académica UDEO — Inicio</title>
  <link rel="stylesheet" href="css/estilos.css">
</head>
<body>
  <header class="header">
    <div class="container header-inner" style="width:100%">
      <a href="inicio.html" class="brand" aria-label="Inicio">
        <div class="brand__logo">
          <img src="../img/logo-udeo.png" alt="Logo" width="44" height="44">
        </div>
        <div class="brand__title">Plataforma Académica UDEO</div>
      </a>

      <input id="nav-toggle" class="nav-toggle" type="checkbox" hidden>
      <label for="nav-toggle" class="nav-btn" aria-label="Abrir menú">
        <span></span>
      </label>

      <nav class="nav">
        <ul class="nav__list">
          <li><a class="nav__link is-active" href="inicio.html">Inicio</a></li>
          <li><a class="nav__link" href="facultades.html">Facultades</a></li>
          <li><a class="nav__link" href="avisos.html">Avisos</a></li>
        </ul>
      </nav>

      <form id="form-busqueda" class="searchbar" role="search" onsubmit="return false;" style="margin-left:12px">
        <input id="search-keywords" class="input" type="search" placeholder="Buscar por palabras clave">
        <button id="btn-search" class="btn btn--primary" type="button">Buscar</button>
      </form>
    </div>
  </header>

  <main>
    <div class="header-spacer"></div>

    <section class="hero hero--home">
      <div class="container hero__wrap">
        <div class="hero__content">
          <span class="hero__kicker">UDEO • Mazatenango</span>
          <h1 class="hero__title">Publicación y consulta de trabajos académicos estudiantiles</h1>
          <p class="hero__desc">Explora artículos, proyectos e investigaciones por facultad y carrera. Encuentra contenidos con tu buscador de palabras clave.</p>
          <div class="hero__actions">
            <a href="facultades.html" class="btn btn--primary">Explorar Facultades</a>
            <a href="#como-funciona" class="btn btn--ghost">Cómo funciona</a>
            <a href="#requisitos" class="btn btn--soft">Requisitos de publicación</a>
          </div>
        </div>

        <div class="util-surface util-pad util-center" style="border-radius:20px;min-height:220px">
          <div class="chips" style="margin-top:0">
            <a class="chip" href="facultades.html">Ensayos</a>
            <a class="chip" href="facultades.html">Investigación</a>
            <a class="chip" href="facultades.html">Proyectos</a>
            <a class="chip" href="facultades.html">Presentaciones</a>
          </div>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="container kpis" id="kpis">
        <div class="kpi">
          <div class="kpi__value" id="kpi-trabajos">—</div>
          <div class="kpi__label">Trabajos publicados</div>
        </div>
        <div class="kpi">
          <div class="kpi__value" id="kpi-facultades">—</div>
          <div class="kpi__label">Facultades</div>
        </div>
        <div class="kpi">
          <div class="kpi__value" id="kpi-carreras">—</div>
          <div class="kpi__label">Carreras</div>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="container util-stack-md">
        <h2 class="section__title">Trabajos destacados</h2>
        <p class="section__subtitle">Una muestra de publicaciones recientes</p>

        <div class="home-cards" id="cards-trabajos">
          <!-- JS inyectará <article class="card">...</article> -->
        </div>

        <div class="pagination" id="paginacion-trabajos">
          <!-- JS inyectará la paginación -->
        </div>

        <div class="util-row" style="justify-content:flex-end">
          <a class="btn btn--ghost" href="facultades.html">Ver todos por Facultad</a>
        </div>
      </div>
    </section>

    <section id="facultades" class="section">
      <div class="container util-stack-md">
        <h2 class="section__title">Explorar por Facultad</h2>
        <p class="section__subtitle">Elige una facultad para ver sus publicaciones</p>

        <div class="faculties-filters">
          <div class="chips">
            <a class="chip" aria-pressed="true" href="facultades.html">Todas</a>
            <a class="chip" href="arquitectura.html">Arquitectura</a>
            <a class="chip" href="ingenieria.html">Ingeniería</a>
            <a class="chip" href="economicas.html">Ciencias Económicas</a>
            <a class="chip" href="humanidades.html">Humanidades</a>
            <a class="chip" href="derecho.html">Derecho</a>
            <a class="chip" href="salud.html">Ciencias de la Salud</a>
          </div>
        </div>

        <div class="faculty-grid">
          <!-- Arquitectura -->
          <article class="faculty-card">
            <div class="faculty-card__banner"></div>
            <div class="faculty-card__body">
              <h3 class="faculty-card__title">Arquitectura</h3>
              <p class="faculty-card__desc">Diseño, proyecto arquitectónico y comunicación visual.</p>
              <div class="faculty-card__meta">
                <span class="badge" id="fac-arq-trabajos">— trabajos</span>
                <span class="badge" id="fac-arq-carreras">— carreras</span>
              </div>
            </div>
            <div class="faculty-card__actions">
              <a class="btn btn--ghost" href="arquitectura.html">Ver detalles</a>
              <a class="btn btn--primary" href="arquitectura.html#ultimos">Ver trabajos</a>
            </div>
          </article>

          <!-- Ingeniería -->
          <article class="faculty-card">
            <div class="faculty-card__banner"></div>
            <div class="faculty-card__body">
              <h3 class="faculty-card__title">Facultad de Ingeniería</h3>
              <p class="faculty-card__desc">Software, redes, electrónica, ciencia de datos y automatización.</p>
              <div class="faculty-card__meta">
                <span class="badge" id="fac-ing-trabajos">— trabajos</span>
                <span class="badge" id="fac-ing-carreras">— carreras</span>
              </div>
            </div>
            <div class="faculty-card__actions">
              <a class="btn btn--ghost" href="ingenieria.html">Ver detalles</a>
              <a class="btn btn--primary" href="ingenieria.html#ultimos">Ver trabajos</a>
            </div>
          </article>

          <!-- Económicas -->
          <article class="faculty-card">
            <div class="faculty-card__banner"></div>
            <div class="faculty-card__body">
              <h3 class="faculty-card__title">Ciencias Económicas</h3>
              <p class="faculty-card__desc">Finanzas, administración, marketing y emprendimiento.</p>
              <div class="faculty-card__meta">
                <span class="badge" id="fac-eco-trabajos">— trabajos</span>
                <span class="badge" id="fac-eco-carreras">— carreras</span>
              </div>
            </div>
            <div class="faculty-card__actions">
              <a class="btn btn--ghost" href="economicas.html">Ver detalles</a>
              <a class="btn btn--primary" href="economicas.html#ultimos">Ver trabajos</a>
            </div>
          </article>

          <!-- Humanidades -->
          <article class="faculty-card">
            <div class="faculty-card__banner"></div>
            <div class="faculty-card__body">
              <h3 class="faculty-card__title">Humanidades</h3>
              <p class="faculty-card__desc">Educación, psicología, comunicación y ciencias sociales.</p>
              <div class="faculty-card__meta">
                <span class="badge" id="fac-hum-trabajos">— trabajos</span>
                <span class="badge" id="fac-hum-carreras">— carreras</span>
              </div>
            </div>
            <div class="faculty-card__actions">
              <a class="btn btn--ghost" href="humanidades.html">Ver detalles</a>
              <a class="btn btn--primary" href="humanidades.html#ultimos">Ver trabajos</a>
            </div>
          </article>

          <!-- Derecho -->
          <article class="faculty-card">
            <div class="faculty-card__banner"></div>
            <div class="faculty-card__body">
              <h3 class="faculty-card__title">Derecho</h3>
              <p class="faculty-card__desc">Análisis de casos, derecho público y privado, y tecnología jurídica.</p>
              <div class="faculty-card__meta">
                <span class="badge" id="fac-der-trabajos">— trabajos</span>
                <span class="badge" id="fac-der-carreras">— carreras</span>
              </div>
            </div>
            <div class="faculty-card__actions">
              <a class="btn btn--ghost" href="derecho.html">Ver detalles</a>
              <a class="btn btn--primary" href="derecho.html#ultimos">Ver trabajos</a>
            </div>
          </article>

          <!-- Ciencias de la Salud -->
          <article class="faculty-card">
            <div class="faculty-card__banner"></div>
            <div class="faculty-card__body">
              <h3 class="faculty-card__title">Ciencias de la Salud</h3>
              <p class="faculty-card__desc">Cuidados, gestión y prácticas clínicas.</p>
              <div class="faculty-card__meta">
                <span class="badge" id="fac-salud-trabajos">— trabajos</span>
                <span class="badge" id="fac-salud-carreras">— carreras</span>
              </div>
            </div>
            <div class="faculty-card__actions">
              <a class="btn btn--ghost" href="salud.html">Ver detalles</a>
              <a class="btn btn--primary" href="salud.html#ultimos">Ver trabajos</a>
            </div>
          </article>
        </div>
      </div>
    </section>

    <section id="como-funciona" class="section">
      <div class="container grid">
        <div class="col-8">
          <div class="faculty-hero util-stack-sm">
            <h3 class="title">Cómo funciona</h3>
            <div class="prose">
              <ol>
                <li>Prepara tu PDF conforme a los requisitos.</li>
                <li>Envía el archivo y metadatos a <strong>repositorio@udeo.edu.gt</strong>.</li>
                <li>Revisión de formato y metadatos en 24–48 h.</li>
                <li>Publicación en la facultad correspondiente.</li>
              </ol>
            </div>
          </div>
        </div>

        <aside class="col-4">
          <div class="sidebar">
            <h4 class="sidebar__title">Accesos rápidos</h4>
            <nav class="list">
              <a href="#requisitos"><span>Requisitos de publicación</span><span>›</span></a>
              <a href="facultades.html"><span>Ver Facultades</span><span>›</span></a>
              <a href="avisos.html"><span>Avisos</span><span>›</span></a>
            </nav>
          </div>
        </aside>
      </div>
    </section>

    <section id="requisitos" class="section">
      <div class="container grid">
        <div class="col-12">
          <div class="faculty-hero">
            <h3 class="title">Requisitos mínimos de publicación</h3>
            <div class="prose" id="requisitos-prose">
              <ul>
                <li>Archivo en PDF (máx. 50 MB).</li>
                <li>Portada institucional, resumen, palabras clave y referencias.</li>
                <li>Metadatos: título, autor(es), carrera, facultad, año, tutor/a y tipo de trabajo.</li>
              </ul>
              <p>Envía tu propuesta a <strong>repositorio@udeo.edu.gt</strong>.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- AVISOS -->
    <section id="avisos" class="section section--tight">
      <div class="container util-stack-md">
        <h2 class="section__title">Avisos</h2>
        <table class="table">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Título</th>
              <th>Resumen</th>
              <th>Acción</th>
            </tr>
          </thead>
          <tbody id="tabla-avisos">
            <!-- JS inyectará filas de avisos -->
          </tbody>
        </table>
        <div class="util-row" style="justify-content:flex-end">
          <a class="btn btn--ghost" href="avisos.html">Ver todos los avisos</a>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container grid">
      <div class="col-12 util-stack-sm">
        <div class="footer__brand">
          <img src="../img/logo-udeo-mini.png" alt="UDEO" width="28" height="28">
          <span>Plataforma Académica UDEO</span>
        </div>
        <div class="footer__bottom">© 2025 Universidad de Occidente — Sede Mazatenango. Todos los derechos reservados.</div>
      </div>
    </div>
  </footer>

  <script src="../js/inicio.js"></script>
  <script src="../js/contenido-inicio.js"></script>

  <!-- Render de AVISOS en la portada -->
  <script>
    (function(){
      function parseFechaDDMMYYYY(s){
        // Devuelve timestamp para ordenar; si falla, 0
        if(!s) return 0;
        const m = String(s).match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2,4})$/);
        if(!m) return 0;
        const d = parseInt(m[1],10), mo = parseInt(m[2],10)-1, y = parseInt(m[3],10);
        const year = y < 100 ? 2000 + y : y;
        return new Date(year, mo, d).getTime() || 0;
      }

      function fillAvisos(){
        if (!window.Repo || !Repo.state) return;
        const tbody = document.getElementById('tabla-avisos');
        if (!tbody) return;

        // Compatibilidad: si existen noticias antiguas, convier­te­las a avisos "al vuelo"
        if (!Array.isArray(Repo.state.avisos)) Repo.state.avisos = [];
        if (Array.isArray(Repo.state.noticias) && Repo.state.noticias.length){
          Repo.state.noticias.forEach(n=>{
            Repo.state.avisos.push({
              id: n.id || crypto.randomUUID(),
              titulo: n.titulo || 'Aviso',
              subtitulo: n.resumen || '',
              fecha: n.fecha || '',
              etiquetas: ['aviso'],
              detalleUrl: n.detalleUrl || (n.url || 'avisos/aviso-generico.html')
            });
          });
          // Limpia noticias para no duplicar
          Repo.state.noticias = [];
        }

        const list = (Repo.state.avisos || [])
          .slice()
          .sort((a,b)=> parseFechaDDMMYYYY(b.fecha) - parseFechaDDMMYYYY(a.fecha));

        tbody.innerHTML = list.map(a=>{
          const fecha = a.fecha || '—';
          const titulo = a.titulo || 'Aviso';
          const resumen = a.subtitulo || '';
          const href = a.detalleUrl || '#';
          return `
            <tr>
              <td>${fecha}</td>
              <td>${titulo}</td>
              <td class="util-muted">${resumen}</td>
              <td><a class="btn btn--ghost" href="${href}">Ver</a></td>
            </tr>`;
        }).join('') || `
          <tr>
            <td colspan="4" class="util-muted">No hay avisos publicados todavía.</td>
          </tr>
        `;
      }

      document.addEventListener('DOMContentLoaded', fillAvisos);
    })();
  </script>
</body>
</html>

